---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [build.gradle.kts, settings.gradle.kts, gradle.properties, shared/build.gradle.kts, shared/src/commonMain/kotlin/com/browsy/Platform.kt, shared/src/commonMain/kotlin/com/browsy/Greeting.kt, shared/src/androidMain/kotlin/com/browsy/Platform.android.kt, shared/src/iosMain/kotlin/com/browsy/Platform.ios.kt, androidApp/build.gradle.kts, iosApp/iosApp.xcodeproj]
autonomous: true
---

<objective>
Initialize Kotlin Multiplatform project with shared module and native targets.

Purpose: Establish the foundational project structure that all subsequent phases build upon. A properly configured KMP project enables code sharing between iOS and Android while preserving native UI capabilities.

Output: Working KMP project that compiles for both platforms with basic shared code demonstrating the cross-platform setup.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create KMP project structure with Gradle configuration</name>
  <files>build.gradle.kts, settings.gradle.kts, gradle.properties, gradle/wrapper/gradle-wrapper.properties</files>
  <action>
Create a new Kotlin Multiplatform project from scratch with:

1. Root `settings.gradle.kts`:
   - Project name: "Browsy"
   - Include modules: `:shared`, `:androidApp`, `:iosApp`
   - Plugin management with Google/Maven repos

2. Root `build.gradle.kts`:
   - Apply kotlin-multiplatform and android plugins via version catalog
   - Configure subprojects for consistent Kotlin version

3. `gradle.properties`:
   - kotlin.code.style=official
   - android.useAndroidX=true
   - org.gradle.jvmargs=-Xmx2048M

4. Use Gradle 8.5+ with Kotlin 2.0.0 (current stable for KMP)
5. Android compile SDK 34, min SDK 24, target SDK 34

Create the gradle wrapper files if they don't exist.
  </action>
  <verify>./gradlew --version runs successfully and shows Kotlin 2.0.0</verify>
  <done>Root Gradle configuration complete with proper KMP plugin setup</done>
</task>

<task type="auto">
  <name>Task 2: Create shared module with expect/actual pattern</name>
  <files>shared/build.gradle.kts, shared/src/commonMain/kotlin/com/browsy/Platform.kt, shared/src/commonMain/kotlin/com/browsy/Greeting.kt, shared/src/androidMain/kotlin/com/browsy/Platform.android.kt, shared/src/iosMain/kotlin/com/browsy/Platform.ios.kt</files>
  <action>
Create the shared module demonstrating KMP's expect/actual pattern:

1. `shared/build.gradle.kts`:
   - Apply kotlin-multiplatform plugin
   - Configure targets: androidTarget(), iosX64(), iosArm64(), iosSimulatorArm64()
   - CommonMain dependencies: none initially (pure Kotlin)
   - AndroidMain: android-specific stdlib
   - IosMain: link as framework named "shared"
   - Package: com.browsy

2. `shared/src/commonMain/kotlin/com/browsy/Platform.kt`:
   - `expect fun getPlatform(): Platform`
   - `interface Platform { val name: String }`

3. `shared/src/commonMain/kotlin/com/browsy/Greeting.kt`:
   - `class Greeting { fun greet(): String = "Hello from ${getPlatform().name}!" }`

4. `shared/src/androidMain/kotlin/com/browsy/Platform.android.kt`:
   - `actual fun getPlatform(): Platform = AndroidPlatform()`
   - `class AndroidPlatform : Platform { override val name = "Android ${android.os.Build.VERSION.SDK_INT}" }`

5. `shared/src/iosMain/kotlin/com/browsy/Platform.ios.kt`:
   - `actual fun getPlatform(): Platform = IOSPlatform()`
   - `class IOSPlatform : Platform { override val name = UIDevice.currentDevice.systemName() + " " + UIDevice.currentDevice.systemVersion }`

Use iosMain as shorthand source set that feeds into all iOS targets.
  </action>
  <verify>./gradlew :shared:build completes successfully</verify>
  <done>Shared module compiles with working expect/actual implementations for both platforms</done>
</task>

<task type="auto">
  <name>Task 3: Create Android app module shell</name>
  <files>androidApp/build.gradle.kts, androidApp/src/main/AndroidManifest.xml, androidApp/src/main/java/com/browsy/android/MainActivity.kt, androidApp/src/main/res/values/strings.xml, androidApp/src/main/res/values/themes.xml</files>
  <action>
Create minimal Android app that uses the shared module:

1. `androidApp/build.gradle.kts`:
   - Apply android application plugin
   - Apply kotlin-android plugin
   - applicationId: "com.browsy.android"
   - Compile SDK 34, min SDK 24, target SDK 34
   - Dependency on project(":shared")
   - Jetpack Compose dependencies (BOM 2024.01.00):
     - activity-compose
     - ui, ui-graphics, ui-tooling-preview
     - material3
   - Build features: compose = true
   - Kotlin compiler extension version for Compose

2. `AndroidManifest.xml`:
   - Package: com.browsy.android
   - Single activity: MainActivity
   - Theme reference

3. `MainActivity.kt`:
   - ComponentActivity with setContent
   - Simple Compose UI showing Greeting().greet() text
   - Material3 theme wrapper

4. Basic res files: strings.xml (app_name = "Browsy"), themes.xml (Material3 DayNight theme)
  </action>
  <verify>./gradlew :androidApp:assembleDebug completes and produces APK</verify>
  <done>Android app shell compiles and displays greeting from shared module</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `./gradlew --version` shows Gradle 8.5+ and Kotlin 2.0.0
- [ ] `./gradlew :shared:build` succeeds
- [ ] `./gradlew :androidApp:assembleDebug` produces APK
- [ ] Project structure matches standard KMP layout
</verification>

<success_criteria>
- All tasks completed
- Gradle builds pass without errors
- Shared module demonstrates working expect/actual pattern
- Android app shell uses shared code successfully
- Project ready for iOS app configuration (Plan 02)
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
